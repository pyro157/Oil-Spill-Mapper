{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9125,"status":"ok","timestamp":1696672218964,"user":{"displayName":"Ziwen Wang","userId":"11913158571439819080"},"user_tz":420},"id":"uUtq88eKMs3_","outputId":"3de26e1a-8a08-43e9-f79f-3ffd22b40d55"},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting pytesseract\n","  Downloading pytesseract-0.3.10-py3-none-any.whl (14 kB)\n","Requirement already satisfied: Pillow in /usr/local/lib/python3.10/dist-packages (9.4.0)\n","Collecting PyPDF2\n","  Downloading pypdf2-3.0.1-py3-none-any.whl (232 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m232.6/232.6 kB\u001b[0m \u001b[31m4.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (2.31.0)\n","Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.10/dist-packages (4.11.2)\n","Collecting pdf2image\n","  Downloading pdf2image-1.16.3-py3-none-any.whl (11 kB)\n","Requirement already satisfied: packaging>=21.3 in /usr/local/lib/python3.10/dist-packages (from pytesseract) (23.2)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests) (3.3.0)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests) (3.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests) (2.0.6)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests) (2023.7.22)\n","Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4) (2.5)\n","Installing collected packages: pytesseract, PyPDF2, pdf2image\n","Successfully installed PyPDF2-3.0.1 pdf2image-1.16.3 pytesseract-0.3.10\n"]}],"source":["pip install pytesseract Pillow PyPDF2 requests beautifulsoup4 pdf2image"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":24017,"status":"ok","timestamp":1696672242977,"user":{"displayName":"Ziwen Wang","userId":"11913158571439819080"},"user_tz":420},"id":"BhPyaprEOXZi","outputId":"6d749dc4-9180-4126-adf4-bc0d5497b093"},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting tesseract\n","  Downloading tesseract-0.1.3.tar.gz (45.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m45.6/45.6 MB\u001b[0m \u001b[31m10.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Building wheels for collected packages: tesseract\n","  Building wheel for tesseract (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for tesseract: filename=tesseract-0.1.3-py3-none-any.whl size=45562550 sha256=cea358ce524f85e76702475527fad8f6313ffe287521b3f678b42cc42df2e4b0\n","  Stored in directory: /root/.cache/pip/wheels/71/c9/aa/698c579693e83fdda9ad6d6f0d8f61ed986e27925ef576f109\n","Successfully built tesseract\n","Installing collected packages: tesseract\n","Successfully installed tesseract-0.1.3\n"]}],"source":["pip install tesseract"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12389,"status":"ok","timestamp":1696672255353,"user":{"displayName":"Ziwen Wang","userId":"11913158571439819080"},"user_tz":420},"id":"GyTuCsU8Ob31","outputId":"b67c5ed1-bf45-46bd-d8cc-33c86089bd9f"},"outputs":[{"name":"stdout","output_type":"stream","text":["Reading package lists... Done\n","Building dependency tree... Done\n","Reading state information... Done\n","The following additional packages will be installed:\n","  tesseract-ocr-eng tesseract-ocr-osd\n","The following NEW packages will be installed:\n","  tesseract-ocr tesseract-ocr-eng tesseract-ocr-osd\n","0 upgraded, 3 newly installed, 0 to remove and 18 not upgraded.\n","Need to get 4,816 kB of archives.\n","After this operation, 15.6 MB of additional disk space will be used.\n","Get:1 http://archive.ubuntu.com/ubuntu jammy/universe amd64 tesseract-ocr-eng all 1:4.00~git30-7274cfa-1.1 [1,591 kB]\n","Get:2 http://archive.ubuntu.com/ubuntu jammy/universe amd64 tesseract-ocr-osd all 1:4.00~git30-7274cfa-1.1 [2,990 kB]\n","Get:3 http://archive.ubuntu.com/ubuntu jammy/universe amd64 tesseract-ocr amd64 4.1.1-2.1build1 [236 kB]\n","Fetched 4,816 kB in 1s (3,332 kB/s)\n","debconf: unable to initialize frontend: Dialog\n","debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at /usr/share/perl5/Debconf/FrontEnd/Dialog.pm line 78, <> line 3.)\n","debconf: falling back to frontend: Readline\n","debconf: unable to initialize frontend: Readline\n","debconf: (This frontend requires a controlling tty.)\n","debconf: falling back to frontend: Teletype\n","dpkg-preconfigure: unable to re-open stdin: \n","Selecting previously unselected package tesseract-ocr-eng.\n","(Reading database ... 120875 files and directories currently installed.)\n","Preparing to unpack .../tesseract-ocr-eng_1%3a4.00~git30-7274cfa-1.1_all.deb ...\n","Unpacking tesseract-ocr-eng (1:4.00~git30-7274cfa-1.1) ...\n","Selecting previously unselected package tesseract-ocr-osd.\n","Preparing to unpack .../tesseract-ocr-osd_1%3a4.00~git30-7274cfa-1.1_all.deb ...\n","Unpacking tesseract-ocr-osd (1:4.00~git30-7274cfa-1.1) ...\n","Selecting previously unselected package tesseract-ocr.\n","Preparing to unpack .../tesseract-ocr_4.1.1-2.1build1_amd64.deb ...\n","Unpacking tesseract-ocr (4.1.1-2.1build1) ...\n","Setting up tesseract-ocr-eng (1:4.00~git30-7274cfa-1.1) ...\n","Setting up tesseract-ocr-osd (1:4.00~git30-7274cfa-1.1) ...\n","Setting up tesseract-ocr (4.1.1-2.1build1) ...\n","Processing triggers for man-db (2.10.2-1) ...\n"]}],"source":["!sudo apt-get install tesseract-ocr"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19935,"status":"ok","timestamp":1696672275276,"user":{"displayName":"Ziwen Wang","userId":"11913158571439819080"},"user_tz":420},"id":"y2zITnhAhA5D","outputId":"9e260f17-844c-4279-81d3-70197bf915a6"},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting PyMuPDF\n","  Downloading PyMuPDF-1.23.4-cp310-none-manylinux2014_x86_64.whl (4.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m4.3/4.3 MB\u001b[0m \u001b[31m10.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting PyMuPDFb==1.23.3 (from PyMuPDF)\n","  Downloading PyMuPDFb-1.23.3-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (30.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m30.6/30.6 MB\u001b[0m \u001b[31m23.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: PyMuPDFb, PyMuPDF\n","Successfully installed PyMuPDF-1.23.4 PyMuPDFb-1.23.3\n"]}],"source":["!pip install PyMuPDF"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":880,"status":"ok","timestamp":1696667408852,"user":{"displayName":"Ziwen Wang","userId":"11913158571439819080"},"user_tz":420},"id":"DSCYB-x_M6sl","outputId":"3fa608dc-8253-49ca-a62b-30e9e6c3384d"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":386},"executionInfo":{"elapsed":183,"status":"error","timestamp":1696671821156,"user":{"displayName":"Ziwen Wang","userId":"11913158571439819080"},"user_tz":420},"id":"xoPh_eo4Naxe","outputId":"ea51d538-84f4-4dd0-b610-17d348d6fc67"},"outputs":[{"ename":"ModuleNotFoundError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mModuleNotFoundError\u001b[0m                       Traceback (most recent call last)","\u001b[0;32m<ipython-input-2-5e7517d68938>\u001b[0m in \u001b[0;36m<cell line: 2>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0;32mimport\u001b[0m \u001b[0mpytesseract\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mPIL\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mImage\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mPyPDF2\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mPdfReader\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mio\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mBytesIO\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mModuleNotFoundError\u001b[0m: No module named 'pytesseract'","","\u001b[0;31m---------------------------------------------------------------------------\u001b[0;32m\nNOTE: If your import is failing due to a missing package, you can\nmanually install dependencies using either !pip or !apt.\n\nTo view examples of installing some common dependencies, click the\n\"Open Examples\" button below.\n\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n"]}],"source":["import os\n","import pytesseract\n","from PIL import Image\n","from PyPDF2 import PdfReader\n","from io import BytesIO\n","from PIL import Image\n","import fitz\n","\n","import io\n","import pandas as pd\n","import re"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lXwAoiwFg52j","outputId":"ccf3b079-5223-402b-9d8f-56cba78e92f5"},"outputs":[{"name":"stdout","output_type":"stream","text":["['W21796.pdf', 'W28599.pdf', 'W25571.pdf', 'W22731.pdf', 'W22249.pdf', 'W28601.pdf', 'W22220.pdf', 'W20863.pdf', 'W20864.pdf', 'W21266.pdf', 'W22247.pdf', 'W11920.pdf', 'W25156.pdf', 'W22221.pdf', 'W25160.pdf', 'W23363.pdf', 'W23365.pdf', 'W28342.pdf', 'W28600.pdf', 'W90258.pdf', 'W15358.pdf', 'W29317.pdf', 'W22099.pdf', 'W23371.pdf', 'W11745.pdf', 'W22740.pdf', 'W23361.pdf', 'W23360.pdf', 'W23364.pdf', 'W23366.pdf', 'W23359.pdf', 'W20407.pdf', 'W23362.pdf', 'W20197.pdf', 'W23230.pdf', 'W28194.pdf', 'W25158.pdf', 'W28633.pdf', 'W28554.pdf', 'W23369.pdf', 'W25159.pdf', 'W23368.pdf', 'W25157.pdf', 'W23372.pdf', 'W28190.pdf', 'W23367.pdf', 'W28557.pdf', 'W28425.pdf', 'W28303.pdf', 'W23370.pdf', 'W28634.pdf', 'W28394.pdf']\n","Error processing image 0 on page 5 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07f880>\n","Error processing image 0 on page 20 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe29850>\n","Error processing image 1 on page 31 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07a200>\n","Error processing image 1 on page 32 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fda30b0>\n","Error processing image 2 on page 32 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fda30b0>\n","Error processing image 3 on page 32 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fda30b0>\n","Error processing image 1 on page 33 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe29850>\n","Error processing image 2 on page 33 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe29850>\n","Error processing image 3 on page 33 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe29850>\n","Error processing image 4 on page 33 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe29850>\n","Error processing image 1 on page 34 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fb218f0>\n","Error processing image 2 on page 34 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fb218f0>\n","Error processing image 12 on page 35 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fda33d0>\n","Error processing image 0 on page 92 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe2a1b0>\n","Error processing image 1 on page 115 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c698a3c40>\n","Error processing image 4 on page 115 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c77c37a60>\n","Error processing image 1 on page 116 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0df510>\n","Error processing image 1 on page 117 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fda31a0>\n","Error processing image 2 on page 117 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fda31a0>\n","Error processing image 1 on page 118 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f27e160>\n","Error processing image 3 on page 118 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07fa10>\n","Error processing image 1 on page 119 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f02e930>\n","Error processing image 2 on page 119 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f02e930>\n","Error processing image 1 on page 120 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c69b62b60>\n","Error processing image 2 on page 120 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c69b62b60>\n","Error processing image 1 on page 121 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f063920>\n","Error processing image 2 on page 121 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f063920>\n","Error processing image 1 on page 122 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fda39c0>\n","Error processing image 3 on page 122 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07fa10>\n","Error processing image 4 on page 122 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07fa10>\n","Error processing image 1 on page 123 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fda39c0>\n","Error processing image 2 on page 123 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fda39c0>\n","Error processing image 1 on page 124 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fb32750>\n","Error processing image 2 on page 124 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fb32750>\n","Error processing image 1 on page 125 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07fa10>\n","Error processing image 2 on page 125 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07fa10>\n","Error processing image 1 on page 126 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f063920>\n","Error processing image 2 on page 126 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f063920>\n","Error processing image 1 on page 127 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07fa10>\n","Error processing image 2 on page 127 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07fa10>\n","Error processing image 1 on page 128 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe2bb00>\n","Error processing image 2 on page 128 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe2bb00>\n","Error processing image 3 on page 128 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe2bb00>\n","Error processing image 4 on page 128 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe2bb00>\n","Error processing image 5 on page 128 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe2bb00>\n","Error processing image 8 on page 128 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe2bb00>\n","Error processing image 1 on page 129 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07a750>\n","Error processing image 3 on page 129 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0bb2e0>\n","Error processing image 4 on page 129 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0bb2e0>\n","Error processing image 5 on page 129 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0bb2e0>\n","Error processing image 10 on page 129 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07b150>\n","Error processing image 1 on page 130 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe2b650>\n","Error processing image 2 on page 130 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe2b650>\n","Error processing image 1 on page 131 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07b150>\n","Error processing image 2 on page 131 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07b150>\n","Error processing image 1 on page 132 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f04ff60>\n","Error processing image 2 on page 132 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f04ff60>\n","Error processing image 1 on page 133 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07fa10>\n","Error processing image 2 on page 133 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07fa10>\n","Error processing image 1 on page 134 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f063920>\n","Error processing image 2 on page 134 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f063920>\n","Error processing image 1 on page 135 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c680bca40>\n","Error processing image 2 on page 135 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c680bca40>\n","Error processing image 3 on page 135 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c680bca40>\n","Error processing image 4 on page 135 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c680bca40>\n","Error processing image 1 on page 136 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe2b650>\n","Error processing image 2 on page 136 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fe2b650>\n","Error processing image 1 on page 137 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c699ffe70>\n","Error processing image 2 on page 137 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c699ffe70>\n","Error processing image 1 on page 138 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f063920>\n","Error processing image 2 on page 138 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f063920>\n","Error processing image 4 on page 138 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f07fa10>\n","Error processing image 1 on page 139 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c699ffe70>\n","Error processing image 2 on page 139 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c699ffe70>\n","Error processing image 4 on page 139 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f04ff60>\n","Error processing image 1 on page 140 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c680bca40>\n","Error processing image 9 on page 140 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fb35260>\n","Error processing image 12 on page 140 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c698a3650>\n","Error processing image 13 on page 140 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c698a3650>\n","Error processing image 17 on page 140 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f10f9c0>\n","Error processing image 19 on page 140 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f54e0>\n","Error processing image 1 on page 141 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f063920>\n","Error processing image 2 on page 141 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f063920>\n","Error processing image 1 on page 142 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fb30180>\n","Error processing image 1 on page 143 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f10f9c0>\n","Error processing image 2 on page 143 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f10f9c0>\n","Error processing image 1 on page 144 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f063920>\n","Error processing image 0 on page 150 of W28756.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fb30180>\n","Error processing image 0 on page 3 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c69b012b0>\n","Error processing image 0 on page 15 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f4ef0>\n","Error processing image 0 on page 18 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f5760>\n","Error processing image 0 on page 20 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0dcbd0>\n","Error processing image 0 on page 21 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fb35850>\n","Error processing image 0 on page 22 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0dd670>\n","Error processing image 0 on page 24 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2fb35990>\n","Error processing image 0 on page 26 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2ef3f560>\n","Error processing image 0 on page 28 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c69b012b0>\n","Error processing image 0 on page 41 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f5a30>\n","Error processing image 0 on page 43 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f6fc0>\n","Error processing image 0 on page 44 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c69700fe0>\n","Error processing image 0 on page 48 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f5ad0>\n","Error processing image 0 on page 56 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f7e70>\n","Error processing image 0 on page 57 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0dd530>\n","Error processing image 0 on page 58 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f7e70>\n","Error processing image 0 on page 61 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f7e70>\n","Error processing image 0 on page 65 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f74c0>\n","Error processing image 0 on page 69 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f7470>\n","Error processing image 0 on page 70 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f03fd80>\n","Error processing image 0 on page 71 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f7470>\n","Error processing image 0 on page 81 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2eed47c0>\n","Error processing image 0 on page 82 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f10f8d0>\n","Error processing image 0 on page 84 of W90329.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2ef3cdb0>\n","Error processing image 0 on page 6 of W30189.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f10ea70>\n","Error processing image 1 on page 88 of W30189.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2ef3c450>\n","Error processing image 1 on page 107 of W30189.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f03fec0>\n","Error processing image 2 on page 107 of W30189.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f03fec0>\n","Error processing image 0 on page 130 of W30189.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0df150>\n","Error processing image 0 on page 137 of W30189.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f7510>\n","Error processing image 0 on page 140 of W30189.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c69b62340>\n","Error processing image 0 on page 142 of W30189.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2eed62f0>\n","Error processing image 0 on page 39 of W36047.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c698a0680>\n","Error processing image 0 on page 136 of W36047.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2ef3c770>\n","Error processing image 0 on page 8 of W29316.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2ef3ff60>\n","Error processing image 0 on page 75 of W29316.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0df290>\n","Error processing image 0 on page 78 of W29316.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f54e0>\n","Error processing image 0 on page 5 of W90244.pdf: cannot identify image file <_io.BytesIO object at 0x7d5c2f0f7e70>\n"]}],"source":["import fitz\n","import pytesseract\n","from PIL import Image\n","import io\n","import os\n","import pandas as pd\n","\n","# Directory containing your PDF files\n","pdf_directory = '/content/drive/Shareddrives/DSCI_560/lab5-part1/data/'\n","\n","# Path to the CSV file\n","csv_file = '/content/drive/Shareddrives/DSCI_560/lab5-part1/final_data.csv'\n","\n","# Read the CSV file to get the list of already included PDF file names\n","existing_df = pd.read_csv(csv_file)\n","existing_files = existing_df['File Name'].tolist()\n","print(existing_files)\n","# Initialize lists to store extracted text data and file names\n","all_text_data = []\n","file_names = []\n","\n","# Iterate through PDF files in the directory\n","for filename in os.listdir(pdf_directory):\n","    if filename.endswith('.pdf') and filename not in existing_files:\n","        # Create the full path to the PDF file\n","        pdf_path = os.path.join(pdf_directory, filename)\n","\n","        # Open the PDF document\n","        pdf_document = fitz.open(pdf_path)\n","\n","        # Initialize a string to store text data from the current PDF file\n","        pdf_text_data = \"\"\n","\n","        # Iterate through pages in the PDF document\n","        for page_number in range(len(pdf_document)):\n","            page = pdf_document.load_page(page_number)\n","            text = page.get_text()\n","\n","            # Append text data from the current page\n","            pdf_text_data += text + \"\\n\"\n","\n","            image_list = page.get_images(full=True)\n","\n","            # Iterate through images on the page\n","            for img_index, img in enumerate(image_list):\n","                xref = img[0]\n","                base_image = pdf_document.extract_image(xref)\n","\n","                if base_image:\n","                    image_data = base_image[\"image\"]\n","\n","                    # Convert image data to bytes\n","                    image_bytes = bytes(image_data)\n","\n","                    # Perform OCR on the image using Pillow (PIL)\n","                    try:\n","                        image = Image.open(io.BytesIO(image_bytes))\n","                        text_data = pytesseract.image_to_string(image)\n","\n","                        # Accumulate text data from the current image\n","                        pdf_text_data += text_data + \"\\n\"\n","                    except Exception as e:\n","                        print(f\"Error processing image {img_index} on page {page_number} of {filename}: {e}\")\n","\n","        # Get the file name of the current PDF file\n","        file_name = filename\n","\n","        # Append the text data and file name to their respective lists\n","        all_text_data.append(pdf_text_data)\n","        file_names.append(file_name)\n","\n","        # Close the PDF document after processing\n","        pdf_document.close()\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":247},"executionInfo":{"elapsed":156,"status":"error","timestamp":1696671791726,"user":{"displayName":"Ziwen Wang","userId":"11913158571439819080"},"user_tz":420},"id":"OzqRuQ_6kaEh","outputId":"a783833c-45d7-4ccb-b127-220a3d55991f"},"outputs":[{"ename":"NameError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-1-01e5e45b2238>\u001b[0m in \u001b[0;36m<cell line: 2>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;31m# Create a DataFrame with extracted text data and file names\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mdf\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mDataFrame\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m{\u001b[0m\u001b[0;34m'File Name'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mfile_names\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'Text Content'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mall_text_data\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;31m# Print or use the DataFrame\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdf\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'pd' is not defined"]}],"source":["# Create a DataFrame with extracted text data and file names\n","df = pd.DataFrame({'File Name': file_names, 'Text Content': all_text_data})\n","\n","# Print or use the DataFrame\n","print(df)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":212,"status":"ok","timestamp":1696571318840,"user":{"displayName":"Ziwen Wang","userId":"11913158571439819080"},"user_tz":420},"id":"oaJAkZwOeFlb","outputId":"f0154b00-9c81-4d79-e78c-f7365f7bd658"},"outputs":[{"name":"stdout","output_type":"stream","text":["     File Name                                       Text Content\n","0   W23369.pdf  \\n \\n\\n \\n\\n0202 62 NViferouddy aed\\n\\nXINO AS...\n","1   W25159.pdf  \\n \\n\\nSUNDRY NOTICES AND REPORTS ON WELLS - F...\n","2   W23368.pdf  \\n \\n\\n \\n\\n \\n\\n \\n\\nXINO ASN ALvLs YOs\\n\\n \\...\n","3   W25157.pdf  \\nNORTH DAKOTA Oil and Gas Division\\n\\nLynn D....\n","4   W23372.pdf  \\n \\n\\n \\n\\n \\n\\nON 819 SIGN\\n\\n \\n\\nAINO ASN ...\n","5   W28190.pdf  \\n \\n\\nG10 SboAOMiea\\n\\nAINO 3SN ALWLS YO\\n\\n4...\n","6   W23367.pdf  \\n \\n\\n \\n\\n \\n\\npanoiddy ajeq\\n\\n \\n \\n  \\n  ...\n","7   W28557.pdf  \\nSUNDRY NOTICES AND REPORTS ON WELLS - FORM 4...\n","8   W28425.pdf  \\n[|\\n\\n \\n\\nSF\\n\\n \\n\\npump\\n\\n \\n\\n \\n\\n \\n\\...\n","9   W28303.pdf  SUNDRY NOTICES AND REPORTS ON WELLS - FORM 4 \\...\n","10  W23370.pdf  \\n \\n\\n     \\n\\nui! . Yo a -\\n\\nkg\\n\\nCLEC onl...\n","11  W28634.pdf  \\n\\n \\n \\n\\nSUNDRY NOTICES AND REPORTS ON WELL...\n","12  W28394.pdf  \\nNORTH DAKOTA Oil and Gas Division\\n\\nLynn D....\n"]}],"source":["\n","# Create a DataFrame with extracted text data and file names\n","df = pd.DataFrame({'File Name': file_names, 'Text Content': all_text_data})\n","\n","# Print or use the DataFrame\n","print(df)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":457},"executionInfo":{"elapsed":172,"status":"ok","timestamp":1696571321233,"user":{"displayName":"Ziwen Wang","userId":"11913158571439819080"},"user_tz":420},"id":"YDDlGajqd_Ao","outputId":"4d796cad-5d35-4c66-e205-eeacd407a7f9"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-fecd9241-a026-4314-8434-f92c901eb305\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>File Name</th>\n","      <th>Text Content</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>W23369.pdf</td>\n","      <td>\\n \\n\\n \\n\\n0202 62 NViferouddy aed\\n\\nXINO AS...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>W25159.pdf</td>\n","      <td>\\n \\n\\nSUNDRY NOTICES AND REPORTS ON WELLS - F...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>W23368.pdf</td>\n","      <td>\\n \\n\\n \\n\\n \\n\\n \\n\\nXINO ASN ALvLs YOs\\n\\n \\...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>W25157.pdf</td>\n","      <td>\\nNORTH DAKOTA Oil and Gas Division\\n\\nLynn D....</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>W23372.pdf</td>\n","      <td>\\n \\n\\n \\n\\n \\n\\nON 819 SIGN\\n\\n \\n\\nAINO ASN ...</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>W28190.pdf</td>\n","      <td>\\n \\n\\nG10 SboAOMiea\\n\\nAINO 3SN ALWLS YO\\n\\n4...</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>W23367.pdf</td>\n","      <td>\\n \\n\\n \\n\\n \\n\\npanoiddy ajeq\\n\\n \\n \\n  \\n  ...</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>W28557.pdf</td>\n","      <td>\\nSUNDRY NOTICES AND REPORTS ON WELLS - FORM 4...</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>W28425.pdf</td>\n","      <td>\\n[|\\n\\n \\n\\nSF\\n\\n \\n\\npump\\n\\n \\n\\n \\n\\n \\n\\...</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>W28303.pdf</td>\n","      <td>SUNDRY NOTICES AND REPORTS ON WELLS - FORM 4 \\...</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>W23370.pdf</td>\n","      <td>\\n \\n\\n     \\n\\nui! . Yo a -\\n\\nkg\\n\\nCLEC onl...</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>W28634.pdf</td>\n","      <td>\\n\\n \\n \\n\\nSUNDRY NOTICES AND REPORTS ON WELL...</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>W28394.pdf</td>\n","      <td>\\nNORTH DAKOTA Oil and Gas Division\\n\\nLynn D....</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fecd9241-a026-4314-8434-f92c901eb305')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-fecd9241-a026-4314-8434-f92c901eb305 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-fecd9241-a026-4314-8434-f92c901eb305');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-33967c83-d23f-4cdf-a095-57e8925ebba3\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-33967c83-d23f-4cdf-a095-57e8925ebba3')\"\n","            title=\"Suggest charts.\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-33967c83-d23f-4cdf-a095-57e8925ebba3 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"text/plain":["     File Name                                       Text Content\n","0   W23369.pdf  \\n \\n\\n \\n\\n0202 62 NViferouddy aed\\n\\nXINO AS...\n","1   W25159.pdf  \\n \\n\\nSUNDRY NOTICES AND REPORTS ON WELLS - F...\n","2   W23368.pdf  \\n \\n\\n \\n\\n \\n\\n \\n\\nXINO ASN ALvLs YOs\\n\\n \\...\n","3   W25157.pdf  \\nNORTH DAKOTA Oil and Gas Division\\n\\nLynn D....\n","4   W23372.pdf  \\n \\n\\n \\n\\n \\n\\nON 819 SIGN\\n\\n \\n\\nAINO ASN ...\n","5   W28190.pdf  \\n \\n\\nG10 SboAOMiea\\n\\nAINO 3SN ALWLS YO\\n\\n4...\n","6   W23367.pdf  \\n \\n\\n \\n\\n \\n\\npanoiddy ajeq\\n\\n \\n \\n  \\n  ...\n","7   W28557.pdf  \\nSUNDRY NOTICES AND REPORTS ON WELLS - FORM 4...\n","8   W28425.pdf  \\n[|\\n\\n \\n\\nSF\\n\\n \\n\\npump\\n\\n \\n\\n \\n\\n \\n\\...\n","9   W28303.pdf  SUNDRY NOTICES AND REPORTS ON WELLS - FORM 4 \\...\n","10  W23370.pdf  \\n \\n\\n     \\n\\nui! . Yo a -\\n\\nkg\\n\\nCLEC onl...\n","11  W28634.pdf  \\n\\n \\n \\n\\nSUNDRY NOTICES AND REPORTS ON WELL...\n","12  W28394.pdf  \\nNORTH DAKOTA Oil and Gas Division\\n\\nLynn D...."]},"execution_count":24,"metadata":{},"output_type":"execute_result"}],"source":["df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CN1aq8qIdvOs"},"outputs":[],"source":["#all_text_data"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rwgclTTjf2Gi"},"outputs":[],"source":["import pandas as pd\n","import re\n","\n","# Function to extract relevant information using regular expressions\n","def extract_information(text):\n","    # Extract API# (American Petroleum Institute number) in the format \"33-053-02102\"\n","    api_number_match = re.search(r'API\\s*#?:?\\s*(\\d{2}-\\d{3}-\\d{5})', text)\n","    api_number = api_number_match.group(1) if api_number_match else None\n","\n","    # Extract WELL NAME\n","    well_name_match = re.search(r'WELL NAME:\\s*(.*?)\\n', text)\n","    well_name = well_name_match.group(1) if well_name_match else None\n","\n","    # Extract WELL NUMBER (up to the next line break)\n","    well_number_match = re.search(r'(?:Well Name and Number|Well Number)\\s+([^\\n]+)', text)\n","    well_number = well_number_match.group(1) if well_number_match else None\n","\n","    # Extract longitude and latitude (assuming they are in decimal degrees)\n","    latitude_match = re.search(r'Latitude\\s*(\\d+°\\d+\\'\\d+\\.\\d+” [NS])', text)\n","    latitude = latitude_match.group(1) if latitude_match else None\n","\n","    longitude_match = re.search(r'Longitude\\s*(-?\\d+°\\d+’\\d+\\.\\d+” [EW])', text)\n","    longitude = longitude_match.group(1) if longitude_match else None\n","\n","    # Extract address (up to the next line break)\n","    address_match = re.search(r'Address\\n\\n(.+?)(?:\\n\\n|\\Z)', text)\n","    address = address_match.group(1).strip() if address_match else None\n","\n","    pattern = r'(\\d{2}/\\d{2}/\\d{4})\\s+(.*?)\\s+(\\d+)\\s+(\\d+)\\s+(\\d+)\\s+(\\d+)\\s+(.*?)$'\n","\n","    # Use regular expression to find matches\n","    stimulation_match = re.search(pattern, text, re.MULTILINE)\n","    date = stimulation_match.group(1) if stimulation_match else None\n","    formation = stimulation_match.group(2) if stimulation_match else None\n","    top_ft = stimulation_match.group(3) if stimulation_match else None\n","    bottom_ft = stimulation_match.group(4) if stimulation_match else None\n","    stages = stimulation_match.group(5) if stimulation_match else None\n","    volume = stimulation_match.group(6) if stimulation_match else None\n","    volume_units = stimulation_match.group(7) if stimulation_match else None\n","\n","    result = {\n","        'API#': api_number,\n","        'WELL NAME': well_name,\n","        'WELL NUMBER': well_number,\n","        'LATITUDE': latitude,\n","        'LONGITUDE': longitude,\n","        'ADDRESS': address,\n","        'Date': date,\n","        'Formation': formation,\n","        'Top (Ft)': top_ft,\n","        'Bottom (Ft)': bottom_ft,\n","        'Stimulation Stages': stages,\n","        'Volume': volume,\n","        'Volume Units': volume_units\n","    }\n","\n","    return result\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TMf1JxzEkbnZ"},"outputs":[],"source":["# Apply the extraction function to the 'Text Content' column and expand the result into separate columns\n","df = df.join(df['Text Content'].apply(extract_information).apply(pd.Series))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":211,"status":"ok","timestamp":1696571330188,"user":{"displayName":"Ziwen Wang","userId":"11913158571439819080"},"user_tz":420},"id":"FDFWrQ5PgMub","outputId":"0d95e3c1-aacd-44e6-bcb8-515937ca0f37"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-a780a2d6-9400-4225-a04a-340fc513b6db\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>File Name</th>\n","      <th>Text Content</th>\n","      <th>API#</th>\n","      <th>WELL NAME</th>\n","      <th>WELL NUMBER</th>\n","      <th>LATITUDE</th>\n","      <th>LONGITUDE</th>\n","      <th>ADDRESS</th>\n","      <th>Date</th>\n","      <th>Formation</th>\n","      <th>Top (Ft)</th>\n","      <th>Bottom (Ft)</th>\n","      <th>Stimulation Stages</th>\n","      <th>Volume</th>\n","      <th>Volume Units</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>W23369.pdf</td>\n","      <td>\\n \\n\\n \\n\\n0202 62 NViferouddy aed\\n\\nXINO AS...</td>\n","      <td>33-105-02729</td>\n","      <td>Atlanta 4-6H</td>\n","      <td>Atlanta 4-6H</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td></td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>W25159.pdf</td>\n","      <td>\\n \\n\\nSUNDRY NOTICES AND REPORTS ON WELLS - F...</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>Footages Qtr-Qtr ection ‘ownship ange il</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>P.O. Box 268870</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>W23368.pdf</td>\n","      <td>\\n \\n\\n \\n\\n \\n\\n \\n\\nXINO ASN ALvLs YOs\\n\\n \\...</td>\n","      <td>33-105-02728</td>\n","      <td>Atlanta Federal 5-6H</td>\n","      <td>Atlanta Federal 6-6H</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>W25157.pdf</td>\n","      <td>\\nNORTH DAKOTA Oil and Gas Division\\n\\nLynn D....</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>Footages</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>robert.sandbo@cir.com</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>W23372.pdf</td>\n","      <td>\\n \\n\\n \\n\\n \\n\\nON 819 SIGN\\n\\n \\n\\nAINO ASN ...</td>\n","      <td>33-105-02732</td>\n","      <td>Atlanta 1-6H</td>\n","      <td>Atlanta 1-6H</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>P.O. Box 269000</td>\n","      <td>12/22/2012</td>\n","      <td>10085'</td>\n","      <td>124</td>\n","      <td>21</td>\n","      <td>18</td>\n","      <td>83</td>\n","      <td>NA</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>W28190.pdf</td>\n","      <td>\\n \\n\\nG10 SboAOMiea\\n\\nAINO 3SN ALWLS YO\\n\\n4...</td>\n","      <td>33-053-05845</td>\n","      <td>Lewis Federal 5300 21-31 6B</td>\n","      <td>[Spacing Unit Description</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>1001 Fannin, Suite 1500</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>W23367.pdf</td>\n","      <td>\\n \\n\\n \\n\\n \\n\\npanoiddy ajeq\\n\\n \\n \\n  \\n  ...</td>\n","      <td>33-105-02727</td>\n","      <td>Atlanta Federal 6-6H</td>\n","      <td>24-HOUR PRODUCTION RATE</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>W28557.pdf</td>\n","      <td>\\nSUNDRY NOTICES AND REPORTS ON WELLS - FORM 4...</td>\n","      <td>33-053-05998</td>\n","      <td>None</td>\n","      <td>Wade Federal 5300 41-30 7T</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>04/24/2015</td>\n","      <td>Three Forks</td>\n","      <td>11167</td>\n","      <td>20517</td>\n","      <td>36</td>\n","      <td>134353</td>\n","      <td>Barrels</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>W28425.pdf</td>\n","      <td>\\n[|\\n\\n \\n\\nSF\\n\\n \\n\\npump\\n\\n \\n\\n \\n\\n \\n\\...</td>\n","      <td>33-053-05954</td>\n","      <td>None</td>\n","      <td>24-HOUR PRODUCTION RATE</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>jswenson@oasispetroleum.com</td>\n","      <td>04/24/2015</td>\n","      <td>Bakken</td>\n","      <td>10032</td>\n","      <td>20425</td>\n","      <td>50</td>\n","      <td>188339</td>\n","      <td>Barrels</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>W28303.pdf</td>\n","      <td>SUNDRY NOTICES AND REPORTS ON WELLS - FORM 4 \\...</td>\n","      <td>33-053-05906</td>\n","      <td>Wade Federal 5300 31-30 11T</td>\n","      <td>Wade Federal 5300 31-30 11T</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>03/29/2015</td>\n","      <td>Three Forks</td>\n","      <td>11080</td>\n","      <td>20453</td>\n","      <td>36</td>\n","      <td>123705</td>\n","      <td>Barrels</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>W23370.pdf</td>\n","      <td>\\n \\n\\n     \\n\\nui! . Yo a -\\n\\nkg\\n\\nCLEC onl...</td>\n","      <td>33-105-02730</td>\n","      <td>Atlanta 3-6H</td>\n","      <td>Atlanta 3-6H</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>P.O. Box 269000</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>W28634.pdf</td>\n","      <td>\\n\\n \\n \\n\\nSUNDRY NOTICES AND REPORTS ON WELL...</td>\n","      <td>33-053-06019</td>\n","      <td>Chalmers 5300 21-19 6B</td>\n","      <td>Name of Contractor(s)</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>Hofistd | T™___|77002</td>\n","      <td>07/19/2015</td>\n","      <td>24</td>\n","      <td>36</td>\n","      <td>164</td>\n","      <td>1606</td>\n","      <td>1552</td>\n","      <td>31 5</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>W28394.pdf</td>\n","      <td>\\nNORTH DAKOTA Oil and Gas Division\\n\\nLynn D....</td>\n","      <td>33-053-05943</td>\n","      <td>None</td>\n","      <td>24-HOUR PRODUCTION RATE</td>\n","      <td>None</td>\n","      <td>None</td>\n","      <td>saqoodrum@oasispetroleum.com</td>\n","      <td>04/08/2015</td>\n","      <td>Three Forks</td>\n","      <td>11079</td>\n","      <td>20187</td>\n","      <td>50</td>\n","      <td>238848</td>\n","      <td>Barrels</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a780a2d6-9400-4225-a04a-340fc513b6db')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-a780a2d6-9400-4225-a04a-340fc513b6db button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-a780a2d6-9400-4225-a04a-340fc513b6db');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-5f4745bf-630d-44e7-b392-ce007e529fd9\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-5f4745bf-630d-44e7-b392-ce007e529fd9')\"\n","            title=\"Suggest charts.\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-5f4745bf-630d-44e7-b392-ce007e529fd9 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"text/plain":["     File Name                                       Text Content  \\\n","0   W23369.pdf  \\n \\n\\n \\n\\n0202 62 NViferouddy aed\\n\\nXINO AS...   \n","1   W25159.pdf  \\n \\n\\nSUNDRY NOTICES AND REPORTS ON WELLS - F...   \n","2   W23368.pdf  \\n \\n\\n \\n\\n \\n\\n \\n\\nXINO ASN ALvLs YOs\\n\\n \\...   \n","3   W25157.pdf  \\nNORTH DAKOTA Oil and Gas Division\\n\\nLynn D....   \n","4   W23372.pdf  \\n \\n\\n \\n\\n \\n\\nON 819 SIGN\\n\\n \\n\\nAINO ASN ...   \n","5   W28190.pdf  \\n \\n\\nG10 SboAOMiea\\n\\nAINO 3SN ALWLS YO\\n\\n4...   \n","6   W23367.pdf  \\n \\n\\n \\n\\n \\n\\npanoiddy ajeq\\n\\n \\n \\n  \\n  ...   \n","7   W28557.pdf  \\nSUNDRY NOTICES AND REPORTS ON WELLS - FORM 4...   \n","8   W28425.pdf  \\n[|\\n\\n \\n\\nSF\\n\\n \\n\\npump\\n\\n \\n\\n \\n\\n \\n\\...   \n","9   W28303.pdf  SUNDRY NOTICES AND REPORTS ON WELLS - FORM 4 \\...   \n","10  W23370.pdf  \\n \\n\\n     \\n\\nui! . Yo a -\\n\\nkg\\n\\nCLEC onl...   \n","11  W28634.pdf  \\n\\n \\n \\n\\nSUNDRY NOTICES AND REPORTS ON WELL...   \n","12  W28394.pdf  \\nNORTH DAKOTA Oil and Gas Division\\n\\nLynn D....   \n","\n","            API#                    WELL NAME  \\\n","0   33-105-02729                Atlanta 4-6H    \n","1           None                         None   \n","2   33-105-02728        Atlanta Federal 5-6H    \n","3           None                         None   \n","4   33-105-02732                Atlanta 1-6H    \n","5   33-053-05845  Lewis Federal 5300 21-31 6B   \n","6   33-105-02727        Atlanta Federal 6-6H    \n","7   33-053-05998                         None   \n","8   33-053-05954                         None   \n","9   33-053-05906  Wade Federal 5300 31-30 11T   \n","10  33-105-02730                Atlanta 3-6H    \n","11  33-053-06019       Chalmers 5300 21-19 6B   \n","12  33-053-05943                         None   \n","\n","                                 WELL NUMBER LATITUDE LONGITUDE  \\\n","0                               Atlanta 4-6H     None      None   \n","1   Footages Qtr-Qtr ection ‘ownship ange il     None      None   \n","2                      Atlanta Federal 6-6H      None      None   \n","3                                   Footages     None      None   \n","4                              Atlanta 1-6H      None      None   \n","5                  [Spacing Unit Description     None      None   \n","6                    24-HOUR PRODUCTION RATE     None      None   \n","7                 Wade Federal 5300 41-30 7T     None      None   \n","8                    24-HOUR PRODUCTION RATE     None      None   \n","9               Wade Federal 5300 31-30 11T      None      None   \n","10                             Atlanta 3-6H      None      None   \n","11                     Name of Contractor(s)     None      None   \n","12                   24-HOUR PRODUCTION RATE     None      None   \n","\n","                         ADDRESS        Date    Formation Top (Ft)  \\\n","0                                       None         None     None   \n","1                P.O. Box 268870        None         None     None   \n","2                           None        None         None     None   \n","3          robert.sandbo@cir.com        None         None     None   \n","4                P.O. Box 269000  12/22/2012       10085'      124   \n","5        1001 Fannin, Suite 1500        None         None     None   \n","6                           None        None         None     None   \n","7                           None  04/24/2015  Three Forks    11167   \n","8    jswenson@oasispetroleum.com  04/24/2015       Bakken    10032   \n","9                           None  03/29/2015  Three Forks    11080   \n","10               P.O. Box 269000        None         None     None   \n","11         Hofistd | T™___|77002  07/19/2015           24       36   \n","12  saqoodrum@oasispetroleum.com  04/08/2015  Three Forks    11079   \n","\n","   Bottom (Ft) Stimulation Stages  Volume Volume Units  \n","0         None               None    None         None  \n","1         None               None    None         None  \n","2         None               None    None         None  \n","3         None               None    None         None  \n","4           21                 18      83           NA  \n","5         None               None    None         None  \n","6         None               None    None         None  \n","7        20517                 36  134353     Barrels   \n","8        20425                 50  188339     Barrels   \n","9        20453                 36  123705     Barrels   \n","10        None               None    None         None  \n","11         164               1606    1552        31 5   \n","12       20187                 50  238848     Barrels   "]},"execution_count":27,"metadata":{},"output_type":"execute_result"}],"source":["df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QhEhdhfMgOBb"},"outputs":[],"source":["# If you want to save the DataFrame to a CSV file, you can do this:\n","csv_file_path = '/content/drive/Shareddrives/DSCI_560/lab5-part1/data4.csv'\n","df.to_csv(csv_file_path, index=False)"]}],"metadata":{"accelerator":"TPU","colab":{"provenance":[{"file_id":"1iUsdwbhop-f1eDvv0g1NmrxTHItqLZ32","timestamp":1696556691803}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}